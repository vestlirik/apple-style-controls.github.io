function hideEditMenu(a){document.getElementById("asc-edit-menu").style.display="none",removePageClickEvent()}function removePageClickEvent(){document.getElementsByTagName("html")[0].removeEventListener("click",hideEditMenu)}function editMenuClick(a,b){removePageClickEvent();var c=document.getElementById("asc-edit-menu");c.style.display="flex";var d=(b||a.target).getBoundingClientRect().top-c.clientHeight-10;c.style.top=d+"px";var e=a.clientX-c.clientWidth/2;e<10&&(e=10),e+c.clientWidth>screen.availWidth&&(e=screen.availWidth-c.clientWidth-20),c.style.left=e+"px";var f=(a.clientX||0)-c.offsetLeft-5;f<5?f=5:f+10+14>=c.clientWidth&&(f=c.clientWidth-10-14),addStyleToHead("div.asc-edit-menu:after{left: "+f+"px;}"),setTimeout(function(){document.getElementsByTagName("html")[0].addEventListener("click",hideEditMenu)},0)}function checkSelectedText(a){var b=document.all?document.selection.createRange().text:document.getSelection();if(b.toString().length>0){var c=b.baseNode.parentElement;c.classList.contains("asc-selectable-text")&&editMenuClick(a,c)}else hideEditMenu(a)}function addStyleToHead(a){var b=document.head||document.getElementsByTagName("head")[0],c=document.createElement("style");c.type="text/css",c.styleSheet?c.styleSheet.cssText=a:c.appendChild(document.createTextNode(a)),b.appendChild(c)}function assignMenuToButtons(){for(var a=document.getElementsByClassName("asc-edit-menu-button"),b=0;b<a.length;b++)a[b].addEventListener("click",editMenuClick)}function applyTextSelecting(){document.getElementsByClassName("asc-selectable-text").length>0&&applyDetectingSelectedText()}function applyDetectingSelectedText(){document.onmouseup=function(a){a.target.classList.contains("asc-edit-menu-button")||setTimeout(function(){checkSelectedText(a)},0)}}function applyActivityIndicators(){for(var a=document.getElementsByClassName("asc-activity-indicator"),b=0;b<a.length;b++)addBars(a[b])}function addBars(a){for(var b=document.createDocumentFragment(),c=0;c<12;c++){var d=document.createElement("div");d.classList.add("bar"+c),b.append(d)}a.appendChild(b)}function getSegmentedControls(){if(!getSegmentedControls.cached){var a=document.getElementsByClassName("asc-segmented-control");getSegmentedControls.cached=a}return getSegmentedControls.cached}function initializeSegmentsBar(){for(var a,b=[],c=getSegmentedControls(),d=0;d<c.length;d++)b.push(c[d].getAttribute("data-label")),c[d].classList.contains("active")&&(a=d);segmentsBar=document.createElement("div"),segmentsBar.classList.add("asc-segmented-bar"),b.forEach(function(a,b){var c=document.createElement("li");c.innerText=a,c.addEventListener("click",function(a){segmentClick(b)}),segmentsBar.appendChild(c)}),void 0===a&&(a=0),applySegmentedBar(),segmentClick(a)}function cleanActiveSegments(){for(var a=getSegmentedControls(),b=0;b<a.length;b++)a[b].classList.remove("active"),segmentsBar.childNodes[b].classList.remove("active")}function segmentClick(a){var b=getSegmentedControls();cleanActiveSegments(),segmentsBar.childNodes[a].classList.add("active"),b[a].classList.add("active")}function applySegmentedBar(){var a=getSegmentedControls();document.getElementsByClassName("asc-segmented-controls")[0].insertBefore(segmentsBar,a[0])}function assignErasers(){for(var a=document.getElementsByClassName("asc-eraser"),b=0;b<a.length;b++)a[b].addEventListener("mousedown",eraseContent)}function eraseContent(a){a.target.previousElementSibling.value="",setTimeout(function(){a.target.previousElementSibling.focus()},0)}hideEditMenu(),assignMenuToButtons(),applyTextSelecting(),applyActivityIndicators();var segmentsBar;initializeSegmentsBar(),assignErasers();